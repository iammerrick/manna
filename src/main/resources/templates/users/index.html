<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" href="/stylesheets/normalize.css" />
    <link rel="stylesheet" href="/stylesheets/fontello.css" />
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0/angular.js"></script>
    <script>
        angular.module('app', [])
                .controller('SubscribeCtrl', function($http, $scope) {
                    var self = this;

                    this.showForm = true;

                    this.name  = '';
                    this.number = '';

                    this.submit = function(e) {
                        e.preventDefault();
                        if (this.friend_number) {
                            this.friend_number = this.friend_number.replace(/(-|\.|_|\s)/g, '');
                        }
                        $http.post('/register', {
                            number: this.number.replace(/(-|\.|_|\s)/g, ''),
                            name: this.name,
                            friend_first_name: this.friend_first_name,
                            friend_number: this.friend_number
                        })
                                .success(function(response) {
                                    self.showForm = false;
                                })
                                .catch(function(err) {
                                    self.errors = err.data.errors;
                                    self.fields = err.data.fields;
                                });
                    }
                });
    </script>
    <div class="Header"><img src="/images/logo.svg" class="Header__logo"/></div>
    <div class="Container">
        <div class="SectionSeparator"></div>
        <div class="Section">
            <div class="Title">Strengthen Willpower!</div>
            <div class="Paragraph">Overcoming bad habits isn't easy. We provide education, tools and daily resources to help stop habits like viewing porn, intrusive sexual thoughts and other unwanted sexual behaviors.</div>
            <div class="IconList">
                <div class="IconListItem">
                    <div class="IconListItem__icon"> <i class="icon-phone"></i></div>
                    <div class="IconListItem__text">Receive daily text messages that empower.</div>
                </div>
                <div class="IconListItem">
                    <div class="IconListItem__icon"> <i class="icon-cap"></i></div>
                    <div class="IconListItem__text">Get skills to successful control your thoughts!</div>
                </div>
                <div class="IconListItem">
                    <div class="IconListItem__icon"> <i class="icon-happy"></i></div>
                    <div class="IconListItem__text">Stay strong with encouragement from a friend.</div>
                </div>
            </div>
        </div>
        <div class="SectionSeparator"></div>
        <div class="Section">
            <div class="Title">Sign up free… It’s on us.</div>
            <div class="SignupForm">
                <form ng-controller="SubscribeCtrl as ctrl" ng-app="app" ng-submit="ctrl.submit($event)">
                    <div ng-if="ctrl.showForm">
                        <div ng-if="ctrl.errors" class="SignupForm__errors">
                            <div ng-repeat="error in ctrl.errors">{{error}}</div>
                        </div>
                        <div class="SignupForm__parallel">
                            <div class="SignupForm__row">
                                <input name="name" type="text" ng-model="ctrl.name" placeholder="First Name" class="SignupForm__input"/>
                            </div>
                            <div class="SignupForm__spacer"></div>
                            <div class="SignupForm__row">
                                <input name="number" type="text" ng-model="ctrl.number" placeholder="Phone Number" class="SignupForm__input"/>
                            </div>
                        </div>
                        <div class="Callout">We recommend adding a friend to help motivate and keep you on track. Your friend will receive occasional messages to help in your success. Your friend must agree to receiving these messages before you add them!</div>
                        <div class="SignupForm__parallel">
                            <div class="SignupForm__row">
                                <input name="friend_first_name" type="text" ng-model="ctrl.friend_first_name" placeholder="Friend's Name" class="SignupForm__input"/>
                            </div>
                            <div class="SignupForm__spacer"></div>
                            <div class="SignupForm__row">
                                <input name="friend_number" type="text" ng-model="ctrl.friend_number" placeholder="Friend's Phone Number" class="SignupForm__input"/>
                            </div>
                        </div>
                        <div class="SignupForm__row">
                            <input type="submit" class="PrimaryButton SignupForm__button"/>
                        </div>
                    </div>
                    <div ng-if="!ctrl.showForm">Thank you!</div>
                </form>
            </div>
            <div class="Description">You can text "STOP" anytime to unsubscribe. Regular carrier SMS rates apply.</div>
        </div>
    </div>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-63324195-1', 'auto');
        ga('send', 'pageview');
    </script>
</body>
</html>